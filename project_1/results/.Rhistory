library(tidyverse)
library(mclust)
library(lubridate)
# Load UMD data and Select variables that is useful
umd_df = read.csv('~/Documents/GitHub/bios611-projects-fall-2019-Jianqiao-Wang/project_1/data/UMD_Services_Provided_20190719.tsv', sep = '\t', header = TRUE)
umd_df = select(umd_df, c(Date, Food.Provided.for, Food.Pounds))
# Formulate Date with as.Date
umd_df$Date = as.Date(umd_df$Date, "%m/%d/%Y")
# Remove rows with missing data and Sort data by Date
umd_df = umd_df %>%
filter(Food.Provided.for > 0, Food.Pounds >= 0) %>%
arrange(Date) %>%
mutate(year=year(Date))
# Plot the data points to see which data should be removed
ggplot(umd_df, aes(Food.Provided.for, Food.Pounds)) +
geom_point(size=0.5) +
labs(x='Number of People Provided for', y='Food Pounds')
ggplot(umd_df, aes(Date, Food.Provided.for)) +
geom_point(size=0.5) +
labs(x='Time', y='Number of People Provided for')
ggplot(umd_df, aes(Date, Food.Pounds)) +
geom_point(size=0.5) +
labs(x='Time', y='Food Pounds')
# Remove outliers and unreasonable data
umd_df = umd_df %>%
filter(Food.Pounds < 100, Food.Provided.for < 60) %>%
filter(Date < as.Date('2019-09-24'), Date > as.Date('2000-01-01'))
# Plot: Total Food Pound in one day ~ Date
total_food_pound = aggregate(Food.Pounds~Date, umd_df, sum)
ggplot(total_food_pound, aes(x=Date, y=Food.Pounds)) +
geom_point(size=0.2) +
labs(x='Time', y='Food Pounds') +
geom_smooth()
# Plot: Number of People that UMD Provided food for in one day ~ Date
total_food_provided_for = aggregate(Food.Provided.for~Date, umd_df, sum)
ggplot(total_food_provided_for, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Food Provided for') +
geom_smooth()
# Plot: Total Food Pound in one day ~ Number of People that UMD Provided food for in one day
ggplot(umd_df, aes(Food.Provided.for, Food.Pounds, color=year)) +
geom_point(size=1) +
labs(x='Number of People', y='Food Pounds')
# EM clustering, 2 cluster
fit = umd_df %>%
select(c(Food.Provided.for, Food.Pounds)) %>%
Mclust(G=2)
umd_df$cluster = as.factor(fit$classification)
umd_df$uncertainty = fit$uncertainty
# Plot: Total Food Pound in one day ~ Number of People that UMD Provided food for in one day
# by cluster with fitted simple linear regression.
ggplot(umd_df, aes(x=Food.Provided.for, y=Food.Pounds, color=cluster, group=cluster)) +
geom_point() +
geom_smooth(method='lm', se=FALSE, formula=y~x-1) +
labs(x='Number of People', y='Food Pounds') +
theme_minimal() +
scale_color_discrete('Group')
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth()
library(tidyverse)
library(mclust)
library(lubridate)
umd_df = read.csv('~/Documents/GitHub/bios611-projects-fall-2019-Jianqiao-Wang/project_1/data/UMD_Services_Provided_20190719.tsv', sep = '\t', header = TRUE)
description = read.csv('~/Documents/GitHub/bios611-projects-fall-2019-Jianqiao-Wang/project_1/data/UMD_Services_Provided_20190719.tsv', sep = '\t', header = TRUE)
umd_df = select(umd_df, c(Date, Food.Provided.for, Food.Pounds))
umd_df$Date = as.Date(umd_df$Date, "%m/%d/%Y")
umd_df = umd_df %>%
filter(Food.Provided.for > 0, Food.Pounds >= 0) %>%
arrange(Date) %>%
mutate(year=year(Date))
ggplot(umd_df, aes(Food.Provided.for, Food.Pounds)) +
geom_point(size=0.5) +
labs(x='Number of People Every Day', y='Total Food Pounds Every Day', title='Total Food Pounds Every Day by Number of People Every Day') +
theme(plot.title = element_text(hjust = 0.5))
ggplot(umd_df, aes(Date, Food.Provided.for)) +
geom_point(size=0.5) +
labs(x='Time', y='Number of Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5))
ggplot(umd_df, aes(Date, Food.Pounds)) +
geom_point(size=0.5) +
labs(x='Time', y='Total Food Pounds Every Day', title='Total Food Pounds Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5))
umd_df = umd_df %>%
filter(Food.Pounds < 100, Food.Provided.for < 60) %>%
filter(Date < as.Date('2019-09-24'), Date > as.Date('2000-01-01'))
number_of_people_every_day = aggregate(Food.Provided.for~Date, umd_df, sum)
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth()
total_food_pound_every_day = aggregate(Food.Pounds~Date, umd_df, sum)
ggplot(total_food_pound_every_day, aes(x=Date, y=Food.Pounds)) +
geom_point(size=0.2) +
labs(x='Time', y='Total Food Pounds Every Day', title='Total Food Pounds Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth()
6:10
seq(2000, 2020)
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = seq(2000, 2020)) +
geom_smooth()
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = seq=2000:2020) +
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = 2000:2020) +
geom_smooth()
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = as.Date(2000:2020)) +
geom_smooth()
as.Date(2000:2020)
as.Date(2000:2020, "%Y")
as.Date(c(2000:2020), "%Y")
seq("2000-01-01", "2020-01-01")
seq(as.Date("2000-01-01"), as.Date("2020-01-01"))
as.Date(c("2000-01-01", "2001-01-01", "2002-01-01", "2003-01-01", "2004-01-01", "2005-01-01", "2006-01-01", "2007-01-01", "2008-01-01"))
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_date(breaks = as.Date(c("2000-01-01", "2001-01-01", "2002-01-01", "2003-01-01", "2004-01-01", "2005-01-01", "2006-01-01", "2007-01-01", "2008-01-01", "2009-01-01", "2010-01-01", "2011-01-01", "2012-01-01", "2013-01-01", "2014-01-01", "2015-01-01", "2016-01-01", "2017-01-01", "2018-01-01", "2019-01-01"))) +
geom_smooth()
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_date(breaks = as.Date(c("2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019"))) +
geom_smooth()
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_date(breaks = as.Date(c("2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019"), "%Y")) +
geom_smooth()
ggplot(number_of_people_every_day, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Number of People Every Day', title='Number of People Every Day over Time') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth()
ggplot(umd_df, aes(Food.Provided.for, Food.Pounds)) +
geom_point(size=1) +
labs(x='Number of People', y='Food Pounds') +
theme(plot.title = element_text(hjust = 0.5))
ggplot(umd_df, aes(Food.Provided.for, Food.Pounds, color=year)) +
geom_point(size=1) +
labs(x='Number of People', y='Food Pounds') +
theme(plot.title = element_text(hjust = 0.5))
ggplot(umd_df, aes(x=Food.Provided.for, y=Food.Pounds, color=cluster, group=cluster)) +
geom_point() +
# geom_smooth(method='lm', se=FALSE, formula=y~x-1) +
labs(x='Number of People', y='Food Pounds') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_minimal() +
scale_color_discrete('Group')
# EM clustering, 2 cluster
fit = umd_df %>%
select(c(Food.Provided.for, Food.Pounds)) %>%
Mclust(G=2)
umd_df$cluster = as.factor(fit$classification)
umd_df$uncertainty = fit$uncertainty
ggplot(umd_df, aes(x=Food.Provided.for, y=Food.Pounds, color=cluster, group=cluster)) +
geom_point() +
# geom_smooth(method='lm', se=FALSE, formula=y~x-1) +
labs(x='Number of People', y='Food Pounds') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_minimal() +
scale_color_discrete('Group')
lm_group1 = lm(Food.Pounds~Food.Provided.for, filter(umd_df, cluster=1))
lm_group1 = lm(Food.Pounds~Food.Provided.for, filter(umd_df, cluster==1))
summary(lm_group1)
lm_group2 = lm(Food.Pounds~Food.Provided.for, filter(umd_df, cluster==2))
summary(lm_group2)
library(tidyverse)
library(mclust)
library(lubridate)
# Load UMD data and Select variables that is useful
umd_df = read.csv('~/Documents/GitHub/bios611-projects-fall-2019-Jianqiao-Wang/project_1/data/UMD_Services_Provided_20190719.tsv', sep = '\t', header = TRUE)
umd_df = select(umd_df, c(Date, Food.Provided.for, Food.Pounds))
# Formulate Date with as.Date
umd_df$Date = as.Date(umd_df$Date, "%m/%d/%Y")
# Remove rows with missing data and Sort data by Date
umd_df = umd_df %>%
drop_na() %>%
#filter(Food.Provided.for > 0, Food.Pounds >= 0) %>%
arrange(Date) %>%
mutate(year=year(Date))
# Remove rows with missing data and Sort data by Date
umd_df = umd_df %>%
drop_na() %>%
filter(Food.Provided.for >= 0, Food.Pounds >= 0) %>%
arrange(Date) %>%
mutate(year=year(Date))
# Load UMD data and Select variables that is useful
umd_df = read.csv('~/Documents/GitHub/bios611-projects-fall-2019-Jianqiao-Wang/project_1/data/UMD_Services_Provided_20190719.tsv', sep = '\t', header = TRUE)
umd_df = select(umd_df, c(Date, Food.Provided.for, Food.Pounds))
# Formulate Date with as.Date
umd_df$Date = as.Date(umd_df$Date, "%m/%d/%Y")
# Remove rows with missing data and Sort data by Date
umd_df = umd_df %>%
drop_na() %>%
# filter(Food.Provided.for >= 0, Food.Pounds >= 0) %>%
arrange(Date) %>%
mutate(year=year(Date))
# Plot the data points to see which data should be removed
ggplot(umd_df, aes(Food.Provided.for, Food.Pounds)) +
geom_point(size=0.5) +
labs(x='Number of People Provided for', y='Food Pounds')
ggplot(umd_df, aes(Date, Food.Provided.for)) +
geom_point(size=0.5) +
labs(x='Time', y='Number of People Provided for')
ggplot(umd_df, aes(Date, Food.Pounds)) +
geom_point(size=0.5) +
labs(x='Time', y='Food Pounds')
# Remove outliers and unreasonable data
umd_df = umd_df %>%
filter(Food.Pounds < 100, Food.Provided.for < 60) %>%
filter(Date < as.Date('2019-09-24'), Date > as.Date('2000-01-01'))
# Plot: Total Food Pound in one day ~ Date
total_food_pound = aggregate(Food.Pounds~Date, umd_df, sum)
ggplot(total_food_pound, aes(x=Date, y=Food.Pounds)) +
geom_point(size=0.2) +
labs(x='Time', y='Food Pounds') +
geom_smooth()
# Plot: Number of People that UMD Provided food for in one day ~ Date
total_food_provided_for = aggregate(Food.Provided.for~Date, umd_df, sum)
ggplot(total_food_provided_for, aes(x=Date, y=Food.Provided.for)) +
geom_point(size=0.2) +
labs(x='Time', y='Food Provided for') +
geom_smooth()
# Plot: Total Food Pound in one day ~ Number of People that UMD Provided food for in one day
ggplot(umd_df, aes(Food.Provided.for, Food.Pounds, color=year)) +
geom_point(size=1) +
labs(x='Number of People', y='Food Pounds')
# EM clustering, 2 cluster
fit = umd_df %>%
select(c(Food.Provided.for, Food.Pounds)) %>%
Mclust(G=2)
umd_df$cluster = as.factor(fit$classification)
umd_df$uncertainty = fit$uncertainty
# Plot: Total Food Pound in one day ~ Number of People that UMD Provided food for in one day
# by cluster with fitted simple linear regression.
ggplot(umd_df, aes(x=Food.Provided.for, y=Food.Pounds, color=cluster, group=cluster)) +
geom_point() +
geom_smooth(method='lm', se=FALSE, formula=y~x-1) +
labs(x='Number of People', y='Food Pounds') +
theme_minimal() +
scale_color_discrete('Group')
# Remove rows with missing data and Sort data by Date
umd_df = umd_df %>%
drop_na() %>%
filter(Food.Provided.for > 0, Food.Pounds >= 0) %>%
arrange(Date) %>%
mutate(year=year(Date))
# Remove rows with missing data and Sort data by Date
umd_df = umd_df %>%
drop_na() %>%
filter(Food.Provided.for > 0, Food.Pounds > 0) %>%
arrange(Date) %>%
mutate(year=year(Date))
